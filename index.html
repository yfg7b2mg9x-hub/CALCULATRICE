<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculatrice Financiers Idylcar</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        const Lock = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
        );
        
        const Calculator = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="4" y="2" width="16" height="20" rx="2"/>
                <line x1="8" y1="6" x2="16" y2="6"/>
                <line x1="16" y1="14" x2="16" y2="18"/>
                <line x1="8" y1="14" x2="8" y2="18"/>
                <line x1="12" y1="14" x2="12" y2="18"/>
            </svg>
        );
        
        const BookOpen = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
            </svg>
        );
        
        const ChevronDown = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="6 9 12 15 18 9"/>
            </svg>
        );
        
        const ChevronUp = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="18 15 12 9 6 15"/>
            </svg>
        );

        const Users = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
        );

        // Fonction de hashage simple pour les mots de passe
        const hashPassword = (password) => {
            let hash = 0;
            for (let i = 0; i < password.length; i++) {
                const char = password.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return hash.toString(36);
        };

        // Initialisation de la base utilisateurs
        const initializeUsers = () => {
            const users = localStorage.getItem('calculatrice_users');
            if (!users) {
                const defaultUsers = [
                    {
                        id: 1,
                        username: 'admin',
                        password: hashPassword('Admin2025!'),
                        role: 'admin',
                        nom: 'Administrateur',
                        actif: true,
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        username: 'vendeur',
                        password: hashPassword('Vendeur2025!'),
                        role: 'user',
                        nom: 'Vendeur Demo',
                        actif: true,
                        createdAt: new Date().toISOString()
                    }
                ];
                localStorage.setItem('calculatrice_users', JSON.stringify(defaultUsers));
            }
        };

        function CalculatriceFinanciers() {
            const [authentifie, setAuthentifie] = useState(false);
            const [utilisateurActuel, setUtilisateurActuel] = useState(null);
            const [username, setUsername] = useState('');
            const [motDePasse, setMotDePasse] = useState('');
            const [erreur, setErreur] = useState('');
            const [tentativesEchouees, setTentativesEchouees] = useState(0);

            const DUREE_SESSION = 2 * 60 * 60 * 1000;
            const MAX_TENTATIVES = 5;

            useEffect(() => {
                initializeUsers();
                const sessionData = sessionStorage.getItem('sessionData');
                if (sessionData) {
                    const { expiration, user } = JSON.parse(sessionData);
                    const maintenant = new Date().getTime();
                    if (maintenant < parseInt(expiration)) {
                        setAuthentifie(true);
                        setUtilisateurActuel(user);
                    } else {
                        sessionStorage.removeItem('sessionData');
                    }
                }
            }, []);

            const verifierConnexion = () => {
                if (tentativesEchouees >= MAX_TENTATIVES) {
                    setErreur('Trop de tentatives √©chou√©es. R√©essayez plus tard.');
                    return;
                }

                const users = JSON.parse(localStorage.getItem('calculatrice_users') || '[]');
                const user = users.find(u =>
                    u.username === username &&
                    u.password === hashPassword(motDePasse) &&
                    u.actif
                );

                if (user) {
                    const expiration = new Date().getTime() + DUREE_SESSION;
                    const sessionData = {
                        expiration: expiration.toString(),
                        user: { id: user.id, username: user.username, role: user.role, nom: user.nom }
                    };
                    sessionStorage.setItem('sessionData', JSON.stringify(sessionData));
                    setAuthentifie(true);
                    setUtilisateurActuel(sessionData.user);
                    setErreur('');
                    setTentativesEchouees(0);
                } else {
                    setTentativesEchouees(tentativesEchouees + 1);
                    setErreur('Nom d\'utilisateur ou mot de passe incorrect');
                    setMotDePasse('');
                }
            };

            const deconnexion = () => {
                sessionStorage.removeItem('sessionData');
                setAuthentifie(false);
                setUtilisateurActuel(null);
                setUsername('');
                setMotDePasse('');
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter') {
                    verifierConnexion();
                }
            };

            const [montantFinance, setMontantFinance] = useState('50000');
            const [volumesAnnuels, setVolumesAnnuels] = useState({
                loisirsfinance: '800000',
                arkea: '800000',
                autre3: '800000',
                autre4: '800000',
                autre5: '800000'
            });
            const [typeFinancement, setTypeFinancement] = useState('credit');
            const [typeBareme, setTypeBareme] = useState('standard');
            const [tauxSpecial, setTauxSpecial] = useState('');
            const [ratioAssurances, setRatioAssurances] = useState('1.5');
            const [bonusReseauIdylcar, setBonusReseauIdylcar] = useState('35000000');
            const [ongletActif, setOngletActif] = useState('calculatrice');
            const [detailsOuverts, setDetailsOuverts] = useState({});
            
            const [assurances, setAssurances] = useState({
                decesEmprunteur: true,
                decesCoEmprunteur: false,
                extensionGarantie: true,
                complementaireFinancement: false,
                assistance: false,
                contratEntretien: false
            });
            
            const [financiers, setFinanciers] = useState([
                { id: 1, nom: 'Loisirs Finance', actif: true, type: 'loisirsfinance' },
                { id: 2, nom: 'Ark√©a', actif: false, type: 'arkea' },
                { id: 3, nom: 'CA Auto Bank', actif: false, type: 'autre', taux: 2.1 },
                { id: 4, nom: 'Santander', actif: false, type: 'autre', taux: 1.9 },
                { id: 5, nom: 'Cofidis', actif: false, type: 'autre', taux: 2.2 }
            ]);

            // States pour la gestion des utilisateurs
            const [utilisateurs, setUtilisateurs] = useState([]);
            const [modeEdition, setModeEdition] = useState(false);
            const [utilisateurEdite, setUtilisateurEdite] = useState(null);
            const [nouveauUser, setNouveauUser] = useState({
                username: '',
                password: '',
                nom: '',
                role: 'user'
            });

            // Charger les utilisateurs depuis localStorage
            useEffect(() => {
                if (authentifie && utilisateurActuel?.role === 'admin') {
                    const users = JSON.parse(localStorage.getItem('calculatrice_users') || '[]');
                    setUtilisateurs(users);
                }
            }, [authentifie, utilisateurActuel]);

            // Gestion des utilisateurs
            const creerUtilisateur = () => {
                if (!nouveauUser.username || !nouveauUser.password || !nouveauUser.nom) {
                    alert('Veuillez remplir tous les champs');
                    return;
                }

                const users = JSON.parse(localStorage.getItem('calculatrice_users') || '[]');
                const existant = users.find(u => u.username === nouveauUser.username);
                if (existant) {
                    alert('Ce nom d\'utilisateur existe d√©j√†');
                    return;
                }

                const nouvelUtilisateur = {
                    id: Math.max(...users.map(u => u.id), 0) + 1,
                    username: nouveauUser.username,
                    password: hashPassword(nouveauUser.password),
                    nom: nouveauUser.nom,
                    role: nouveauUser.role,
                    actif: true,
                    createdAt: new Date().toISOString()
                };

                users.push(nouvelUtilisateur);
                localStorage.setItem('calculatrice_users', JSON.stringify(users));
                setUtilisateurs(users);
                setNouveauUser({ username: '', password: '', nom: '', role: 'user' });
                setModeEdition(false);
            };

            const resetMotDePasse = (userId) => {
                const nouveauMdp = prompt('Entrez le nouveau mot de passe :');
                if (nouveauMdp && nouveauMdp.length >= 6) {
                    const users = JSON.parse(localStorage.getItem('calculatrice_users') || '[]');
                    const index = users.findIndex(u => u.id === userId);
                    if (index !== -1) {
                        users[index].password = hashPassword(nouveauMdp);
                        localStorage.setItem('calculatrice_users', JSON.stringify(users));
                        setUtilisateurs(users);
                        alert('Mot de passe r√©initialis√© avec succ√®s');
                    }
                } else {
                    alert('Le mot de passe doit contenir au moins 6 caract√®res');
                }
            };

            const toggleActifUser = (userId) => {
                const users = JSON.parse(localStorage.getItem('calculatrice_users') || '[]');
                const index = users.findIndex(u => u.id === userId);
                if (index !== -1) {
                    if (users[index].role === 'admin' && users.filter(u => u.role === 'admin' && u.actif).length === 1) {
                        alert('Impossible de d√©sactiver le dernier administrateur actif');
                        return;
                    }
                    users[index].actif = !users[index].actif;
                    localStorage.setItem('calculatrice_users', JSON.stringify(users));
                    setUtilisateurs(users);
                }
            };

            const supprimerUtilisateur = (userId) => {
                const user = utilisateurs.find(u => u.id === userId);
                if (user && user.role === 'admin' && utilisateurs.filter(u => u.role === 'admin').length === 1) {
                    alert('Impossible de supprimer le dernier administrateur');
                    return;
                }
                if (confirm('√ätes-vous s√ªr de vouloir supprimer cet utilisateur ?')) {
                    const users = JSON.parse(localStorage.getItem('calculatrice_users') || '[]');
                    const nouveauxUsers = users.filter(u => u.id !== userId);
                    localStorage.setItem('calculatrice_users', JSON.stringify(nouveauxUsers));
                    setUtilisateurs(nouveauxUsers);
                }
            };

            const compterAssurancesLF = () => {
                let count = 0;
                if (assurances.decesEmprunteur) count++;
                if (assurances.decesCoEmprunteur) count++;
                if (assurances.extensionGarantie) count++;
                if (assurances.complementaireFinancement) count++;
                if (assurances.contratEntretien) count++;
                return count;
            };

            const calculerLoisirsFinance = () => {
                const mf = parseFloat(montantFinance) || 0;
                const va = parseFloat(volumesAnnuels.loisirsfinance) || 0;
                const ratio = parseFloat(ratioAssurances) || 0;
                const bonusReseau = parseFloat(bonusReseauIdylcar) || 35000000;

                let primeBase = typeFinancement === 'loa' ? 5 : 4;
                if (typeBareme === 'special' && tauxSpecial) {
                    primeBase = parseFloat(tauxSpecial) || primeBase;
                }

                const nbAss = compterAssurancesLF();
                let coeff = 1;
                if (nbAss === 0) coeff = 0;
                else if (nbAss === 1) coeff = 0.5;
                else if (nbAss >= 3) coeff = 1.25;

                const commBase = (mf * primeBase * coeff) / 100;

                const paliersVol = [
                    [2500000, 3.5], [2000000, 3.3], [1750000, 3.1], [1500000, 2.8],
                    [1250000, 2.6], [1000000, 2.3], [750000, 2], [500000, 1.7], [0, 0.8]
                ];
                let tauxVol = 0.8;
                for (let [s, t] of paliersVol) {
                    if (va >= s) { tauxVol = t; break; }
                }
                const primeVol = (mf * tauxVol) / 100;

                const bonusRes = [[35000000, 0.4], [30000000, 0.3], [25000000, 0.2], [23000000, 0.1]];
                let tauxBonusRes = 0;
                for (let [s, b] of bonusRes) {
                    if (bonusReseau >= s) { tauxBonusRes = b; break; }
                }
                const montantBonusRes = (mf * tauxBonusRes) / 100;

                let commInter = 0;
                let partDossierInter = 0;
                if (va >= 305000) {
                    const interPaliers = [[1.80, 0.75], [1.60, 0.7], [1.40, 0.5], [1.30, 0.4], [1.20, 0.3], [1.10, 0.1]];
                    let tauxInter = 0;
                    for (let [r, t] of interPaliers) {
                        if (ratio >= r) { tauxInter = t; break; }
                    }
                    const bonusAnnuelTotal = (va * tauxInter) / 100;
                    partDossierInter = (mf / va) * bonusAnnuelTotal;
                    commInter = bonusAnnuelTotal;
                }

                return {
                    commBase,
                    primeVol,
                    montantBonusRes,
                    commInter,
                    partDossierInter,
                    total: commBase + primeVol + montantBonusRes + partDossierInter,
                    totalMensuel: commBase,
                    totalAnnuel: primeVol + montantBonusRes + partDossierInter,
                    details: { primeBase, coeff, nbAss, tauxVol, tauxBonusRes }
                };
            };

            const calculerArkea = () => {
                const mf = parseFloat(montantFinance) || 0;
                const va = parseFloat(volumesAnnuels.arkea) || 0;
                const ratio = parseFloat(ratioAssurances) || 0;

                // 1. R√©mun√©ration de base
                const tauxBase = typeFinancement === 'loa' ? 3.5 : 2.5;
                const commBase = (mf * tauxBase) / 100;

                // 2. Commissions sur assurances
                let commAssurances = 0;
                let montantsForfaitaires = 0;
                let nbAssurancesArkea = 0;

                // Assurances en pourcentage
                if (assurances.decesEmprunteur) {
                    commAssurances += (mf * 0.7) / 100;
                    nbAssurancesArkea++;
                }
                if (assurances.decesCoEmprunteur) {
                    commAssurances += (mf * 0.7) / 100;
                    nbAssurancesArkea++;
                }
                if (assurances.complementaireFinancement) {
                    commAssurances += (mf * 0.7) / 100;
                    nbAssurancesArkea++;
                }

                // Assurances forfaitaires
                if (assurances.extensionGarantie) {
                    montantsForfaitaires += 30;
                    nbAssurancesArkea++;
                }
                if (assurances.contratEntretien) {
                    montantsForfaitaires += 60;
                    nbAssurancesArkea++;
                }

                // 3. Prime de volume annuel
                const paliersVolumeArkea = [
                    [2225000, 3.0],
                    [2000000, 2.8],
                    [1500000, 2.4],
                    [1000000, 2.15],
                    [750000, 1.9],
                    [500000, 1.65],
                    [0, 1.15]
                ];
                let tauxVolume = 1.15;
                for (let [seuil, taux] of paliersVolumeArkea) {
                    if (va >= seuil) {
                        tauxVolume = taux;
                        break;
                    }
                }
                const primeVolume = (mf * tauxVolume) / 100;

                // 4. Prime sur taux de recours aux assurances
                let primeRecours = 0;
                if (ratio >= 1.85) {
                    primeRecours = (mf * 0.4) / 100;
                } else if (ratio >= 1.75) {
                    primeRecours = (mf * 0.3) / 100;
                } else if (ratio >= 1.65) {
                    primeRecours = (mf * 0.2) / 100;
                }

                // 5. Prime d'animation vendeur (0,25% si au moins une assurance)
                let primeAnimation = 0;
                if (nbAssurancesArkea > 0) {
                    primeAnimation = (mf * 0.25) / 100;
                }

                // Calcul du total
                const totalMensuel = commBase + commAssurances + montantsForfaitaires;
                const totalAnnuel = primeVolume + primeRecours + primeAnimation;
                const total = totalMensuel + totalAnnuel;

                return {
                    commBase,
                    commAssurances,
                    montantsForfaitaires,
                    primeVolume,
                    primeRecours,
                    primeAnimation,
                    total,
                    totalMensuel,
                    totalAnnuel,
                    details: {
                        tauxBase,
                        nbAssurancesArkea,
                        tauxVolume,
                        ratio
                    }
                };
            };

            const calculerAutre = (f) => {
                const mf = parseFloat(montantFinance) || 0;
                const comm = (mf * f.taux) / 100;
                return { total: comm, comm, details: { taux: f.taux } };
            };

            const toggleFinancier = (id) => {
                setFinanciers(financiers.map(f => f.id === id ? { ...f, actif: !f.actif } : f));
            };

            const financiersActifs = financiers.filter(f => f.actif);
            const resultats = financiersActifs.map(f => {
                let rem;
                if (f.type === 'loisirsfinance') {
                    rem = calculerLoisirsFinance();
                } else if (f.type === 'arkea') {
                    rem = calculerArkea();
                } else {
                    rem = calculerAutre(f);
                }
                return { ...f, rem };
            }).sort((a, b) => b.rem.total - a.rem.total);

            if (!authentifie) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-600 to-blue-700 flex items-center justify-center p-6">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                            <div className="text-center mb-8">
                                <div className="inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4">
                                    <Lock />
                                </div>
                                <h1 className="text-2xl font-bold text-gray-800 mb-2">Acc√®s s√©curis√©</h1>
                                <p className="text-gray-600">Calculatrice Financiers Idylcar</p>
                            </div>

                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Nom d'utilisateur
                                    </label>
                                    <input
                                        type="text"
                                        value={username}
                                        onChange={(e) => {
                                            setUsername(e.target.value);
                                            setErreur('');
                                        }}
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                        placeholder="Entrez votre nom d'utilisateur"
                                        autoFocus
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Mot de passe
                                    </label>
                                    <input
                                        type="password"
                                        value={motDePasse}
                                        onChange={(e) => {
                                            setMotDePasse(e.target.value);
                                            setErreur('');
                                        }}
                                        onKeyPress={handleKeyPress}
                                        className={`w-full px-4 py-3 border-2 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent ${
                                            erreur ? 'border-red-500' : 'border-gray-300'
                                        }`}
                                        placeholder="Entrez votre mot de passe"
                                    />
                                    {erreur && (
                                        <p className="mt-2 text-sm text-red-600">
                                            ‚ùå {erreur}
                                        </p>
                                    )}
                                    {tentativesEchouees > 0 && tentativesEchouees < MAX_TENTATIVES && (
                                        <p className="mt-1 text-xs text-orange-600">
                                            {MAX_TENTATIVES - tentativesEchouees} tentative(s) restante(s)
                                        </p>
                                    )}
                                </div>

                                <button
                                    onClick={verifierConnexion}
                                    disabled={tentativesEchouees >= MAX_TENTATIVES}
                                    className="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition disabled:bg-gray-400 disabled:cursor-not-allowed"
                                >
                                    Se connecter
                                </button>

                                <p className="text-xs text-center text-gray-500 mt-4">
                                    üîí Session valable 2 heures
                                </p>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
                    <div className="max-w-7xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-xl mb-6">
                            <div className="flex items-center justify-between p-6 border-b">
                                <div className="flex items-center gap-3">
                                    <Calculator />
                                    <div>
                                        <h1 className="text-3xl font-bold text-gray-800">Calculatrice Financiers</h1>
                                        <p className="text-sm text-gray-500 mt-1">
                                            üë§ {utilisateurActuel?.nom} {utilisateurActuel?.role === 'admin' && '(Administrateur)'}
                                        </p>
                                    </div>
                                </div>
                                <div className="flex items-center gap-2">
                                    <div className="flex gap-2 mr-4">
                                        <button onClick={() => setOngletActif('calculatrice')}
                                            className={`px-6 py-2 rounded-lg font-medium transition ${ongletActif === 'calculatrice' ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}`}>
                                            Calculatrice
                                        </button>
                                        <button onClick={() => setOngletActif('baremes')}
                                            className={`px-6 py-2 rounded-lg font-medium transition ${ongletActif === 'baremes' ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}`}>
                                            Bar√®mes
                                        </button>
                                        {utilisateurActuel?.role === 'admin' && (
                                            <button onClick={() => setOngletActif('utilisateurs')}
                                                className={`px-6 py-2 rounded-lg font-medium transition ${ongletActif === 'utilisateurs' ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}`}>
                                                üë• Utilisateurs
                                            </button>
                                        )}
                                    </div>
                                    <button onClick={deconnexion}
                                        className="px-4 py-2 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 transition">
                                        D√©connexion
                                    </button>
                                </div>
                            </div>

                            {ongletActif === 'calculatrice' && (
                                <div className="p-8">
                                    <div className="grid md:grid-cols-3 gap-6 mb-8">
                                        <div>
                                            <h2 className="text-lg font-semibold text-gray-700 mb-4">üí∞ Dossier</h2>
                                            <div className="space-y-3">
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-600 mb-1">Montant financ√© (‚Ç¨)</label>
                                                    <input type="number" value={montantFinance} onChange={(e) => setMontantFinance(e.target.value)}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" />
                                                </div>
                                                
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-600 mb-2">Type financement</label>
                                                    <div className="flex gap-2">
                                                        <button onClick={() => setTypeFinancement('credit')}
                                                            className={`flex-1 px-4 py-2 rounded-lg font-medium ${typeFinancement === 'credit' ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600'}`}>
                                                            Cr√©dit
                                                        </button>
                                                        <button onClick={() => setTypeFinancement('loa')}
                                                            className={`flex-1 px-4 py-2 rounded-lg font-medium ${typeFinancement === 'loa' ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600'}`}>
                                                            LOA
                                                        </button>
                                                    </div>
                                                </div>

                                                <div>
                                                    <label className="block text-sm font-medium text-gray-600 mb-2">Bar√®me</label>
                                                    <div className="flex gap-2">
                                                        <button onClick={() => setTypeBareme('standard')}
                                                            className={`flex-1 px-4 py-2 rounded-lg text-sm font-medium ${typeBareme === 'standard' ? 'bg-green-600 text-white' : 'bg-gray-100 text-gray-600'}`}>
                                                            Standard
                                                        </button>
                                                        <button onClick={() => setTypeBareme('special')}
                                                            className={`flex-1 px-4 py-2 rounded-lg text-sm font-medium ${typeBareme === 'special' ? 'bg-orange-600 text-white' : 'bg-gray-100 text-gray-600'}`}>
                                                            Sp√©cial
                                                        </button>
                                                    </div>
                                                    {typeBareme === 'special' && (
                                                        <input type="number" step="0.1" placeholder="Taux manuel %" value={tauxSpecial}
                                                            onChange={(e) => setTauxSpecial(e.target.value)}
                                                            className="w-full mt-2 px-4 py-2 border border-orange-300 rounded-lg" />
                                                    )}
                                                </div>
                                            </div>
                                        </div>

                                        <div>
                                            <h2 className="text-lg font-semibold text-gray-700 mb-4">üõ°Ô∏è Assurances</h2>
                                            <div className="space-y-2">
                                                {[
                                                    ['decesEmprunteur', 'D√©c√®s emprunteur'],
                                                    ['decesCoEmprunteur', 'D√©c√®s co-emprunteur'],
                                                    ['extensionGarantie', 'Extension garantie'],
                                                    ['complementaireFinancement', 'Compl√©mentaire financement'],
                                                    ['assistance', 'Assistance'],
                                                    ['contratEntretien', 'Contrat entretien']
                                                ].map(([k, l]) => (
                                                    <label key={k} className="flex items-center gap-2 cursor-pointer">
                                                        <input type="checkbox" checked={assurances[k]}
                                                            onChange={(e) => setAssurances({...assurances, [k]: e.target.checked})}
                                                            className="w-4 h-4 text-indigo-600 rounded" />
                                                        <span className="text-sm text-gray-700">{l}</span>
                                                    </label>
                                                ))}
                                            </div>
                                            <div className="mt-3 space-y-1">
                                                <div className="p-2 bg-blue-50 rounded text-xs text-blue-700">
                                                    ‚ÑπÔ∏è L'assistance n'est propos√©e que par Loisirs Finance et ne compte pas dans le volume d'assurance
                                                </div>
                                                <div className="p-2 bg-purple-50 rounded text-xs text-purple-700">
                                                    ‚ÑπÔ∏è L'entretien n'est propos√© que par Ark√©a et compte comme une assurance
                                                </div>
                                            </div>
                                        </div>

                                        <div>
                                            <h2 className="text-lg font-semibold text-gray-700 mb-4">üìä Objectifs Annuels</h2>
                                            <div className="space-y-3">
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-600 mb-1">Objectif annuel Loisirs Finance (‚Ç¨)</label>
                                                    <input type="number" value={volumesAnnuels.loisirsfinance}
                                                        onChange={(e) => setVolumesAnnuels({...volumesAnnuels, loisirsfinance: e.target.value})}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg" />
                                                </div>
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-600 mb-1">Objectif annuel Ark√©a (‚Ç¨)</label>
                                                    <input type="number" value={volumesAnnuels.arkea}
                                                        onChange={(e) => setVolumesAnnuels({...volumesAnnuels, arkea: e.target.value})}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg" />
                                                </div>
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-600 mb-1">Objectif annuel CA Auto Bank (‚Ç¨)</label>
                                                    <input type="number" value={volumesAnnuels.autre3}
                                                        onChange={(e) => setVolumesAnnuels({...volumesAnnuels, autre3: e.target.value})}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg" />
                                                </div>
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-600 mb-1">Objectif annuel Santander (‚Ç¨)</label>
                                                    <input type="number" value={volumesAnnuels.autre4}
                                                        onChange={(e) => setVolumesAnnuels({...volumesAnnuels, autre4: e.target.value})}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg" />
                                                </div>
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-600 mb-1">Objectif annuel Cofidis (‚Ç¨)</label>
                                                    <input type="number" value={volumesAnnuels.autre5}
                                                        onChange={(e) => setVolumesAnnuels({...volumesAnnuels, autre5: e.target.value})}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg" />
                                                </div>
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-600 mb-1">Ratio ass./dossier</label>
                                                    <select value={ratioAssurances} onChange={(e) => setRatioAssurances(e.target.value)}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                                                        <option value="1.09">Moins de 1,10</option>
                                                        <option value="1.10">‚â• 1,10</option>
                                                        <option value="1.20">‚â• 1,20</option>
                                                        <option value="1.30">‚â• 1,30</option>
                                                        <option value="1.40">‚â• 1,40</option>
                                                        <option value="1.60">‚â• 1,60</option>
                                                        <option value="1.80">‚â• 1,80</option>
                                                    </select>
                                                    <p className="text-xs text-gray-500 mt-1">Pour interm√©diation LF</p>
                                                </div>
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-600 mb-1">CA r√©seau Idylcar</label>
                                                    <select value={bonusReseauIdylcar} onChange={(e) => setBonusReseauIdylcar(e.target.value)}
                                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                                                        <option value="0">Moins de 23M‚Ç¨</option>
                                                        <option value="23000000">‚â• 23M‚Ç¨ (+0,1%)</option>
                                                        <option value="25000000">‚â• 25M‚Ç¨ (+0,2%)</option>
                                                        <option value="30000000">‚â• 30M‚Ç¨ (+0,3%)</option>
                                                        <option value="35000000">‚â• 35M‚Ç¨ (+0,4%)</option>
                                                    </select>
                                                    <p className="text-xs text-gray-500 mt-1">Pour bonus r√©seau LF</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <h2 className="text-lg font-semibold text-gray-700 mb-4">üè¶ Financiers</h2>
                                        <div className="flex flex-wrap gap-3">
                                            {financiers.map(f => (
                                                <label key={f.id} className="flex items-center gap-2 px-4 py-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100">
                                                    <input type="checkbox" checked={f.actif} onChange={() => toggleFinancier(f.id)}
                                                        className="w-5 h-5 text-indigo-600 rounded" />
                                                    <span className="font-medium text-gray-700">{f.nom}</span>
                                                </label>
                                            ))}
                                        </div>
                                    </div>
                                </div>
                            )}

                            {ongletActif === 'baremes' && (
                                <div className="p-8">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-6">üìã Bar√®mes Loisirs Finance</h2>
                                    
                                    <div className="grid md:grid-cols-2 gap-6">
                                        <div className="bg-indigo-50 p-4 rounded-lg">
                                            <h4 className="font-semibold text-gray-800 mb-3">Prime de base</h4>
                                            <div className="space-y-2 text-sm">
                                                <div className="flex justify-between"><span>Cr√©dit :</span><span className="font-bold">4%</span></div>
                                                <div className="flex justify-between"><span>LOA :</span><span className="font-bold">5%</span></div>
                                            </div>
                                        </div>

                                        <div className="bg-indigo-50 p-4 rounded-lg">
                                            <h4 className="font-semibold text-gray-800 mb-3">Coefficient assurances</h4>
                                            <div className="space-y-2 text-sm">
                                                <div className="flex justify-between"><span>0 :</span><span className="font-bold text-red-600">0%</span></div>
                                                <div className="flex justify-between"><span>1 :</span><span className="font-bold text-orange-600">50%</span></div>
                                                <div className="flex justify-between"><span>2 :</span><span className="font-bold text-green-600">100%</span></div>
                                                <div className="flex justify-between"><span>3+ :</span><span className="font-bold text-blue-600">125%</span></div>
                                            </div>
                                        </div>

                                        <div className="bg-indigo-50 p-4 rounded-lg">
                                            <h4 className="font-semibold text-gray-800 mb-3">Prime volume</h4>
                                            <div className="space-y-1 text-xs">
                                                {[
                                                    ['< 500k', '0,8%'], ['‚â• 500k', '1,7%'], ['‚â• 750k', '2%'], ['‚â• 1M', '2,3%'],
                                                    ['‚â• 1,25M', '2,6%'], ['‚â• 1,5M', '2,8%'], ['‚â• 1,75M', '3,1%'],
                                                    ['‚â• 2M', '3,3%'], ['‚â• 2,5M', '3,5%']
                                                ].map(([s, t], i) => (
                                                    <div key={i} className="flex justify-between py-1 border-b border-indigo-200">
                                                        <span>{s}</span><span className="font-bold">{t}</span>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>

                                        <div className="bg-indigo-50 p-4 rounded-lg">
                                            <h4 className="font-semibold text-gray-800 mb-3">Bonus r√©seau</h4>
                                            <div className="space-y-2 text-sm">
                                                {[['23M', '0,1%'], ['25M', '0,2%'], ['30M', '0,3%'], ['35M', '0,4%']].map(([s, b], i) => (
                                                    <div key={i} className="flex justify-between"><span>‚â• {s} :</span><span className="font-bold">{b}</span></div>
                                                ))}
                                            </div>
                                        </div>

                                        <div className="bg-indigo-50 p-4 rounded-lg col-span-2">
                                            <h4 className="font-semibold text-gray-800 mb-3">Commission interm√©diation (si CA ‚â• 305k)</h4>
                                            <div className="grid grid-cols-3 gap-4 text-sm">
                                                {[['1,10', '0,1%'], ['1,20', '0,3%'], ['1,30', '0,4%'], ['1,40', '0,5%'], ['1,60', '0,7%'], ['1,80', '0,75%']].map(([r, t], i) => (
                                                    <div key={i} className="flex justify-between"><span>‚â• {r} :</span><span className="font-bold">{t}</span></div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>

                                    <h2 className="text-2xl font-bold text-gray-800 mb-6 mt-12">üìã Bar√®mes Ark√©a</h2>

                                    <div className="grid md:grid-cols-2 gap-6">
                                        <div className="bg-purple-50 p-4 rounded-lg">
                                            <h4 className="font-semibold text-gray-800 mb-3">R√©mun√©ration de base</h4>
                                            <div className="space-y-2 text-sm">
                                                <div className="flex justify-between"><span>Cr√©dit :</span><span className="font-bold">2,5%</span></div>
                                                <div className="flex justify-between"><span>LOA :</span><span className="font-bold">3,5%</span></div>
                                            </div>
                                        </div>

                                        <div className="bg-purple-50 p-4 rounded-lg">
                                            <h4 className="font-semibold text-gray-800 mb-3">Assurances (pourcentage)</h4>
                                            <div className="space-y-2 text-sm">
                                                <div className="flex justify-between"><span>D√©c√®s emprunteur :</span><span className="font-bold">0,7%</span></div>
                                                <div className="flex justify-between"><span>D√©c√®s co-emprunteur :</span><span className="font-bold">0,7%</span></div>
                                                <div className="flex justify-between"><span>Compl√©mentaire :</span><span className="font-bold">0,7%</span></div>
                                            </div>
                                        </div>

                                        <div className="bg-purple-50 p-4 rounded-lg">
                                            <h4 className="font-semibold text-gray-800 mb-3">Assurances (forfait)</h4>
                                            <div className="space-y-2 text-sm">
                                                <div className="flex justify-between"><span>Extension garantie :</span><span className="font-bold">30‚Ç¨</span></div>
                                                <div className="flex justify-between"><span>Contrat entretien :</span><span className="font-bold">60‚Ç¨</span></div>
                                            </div>
                                        </div>

                                        <div className="bg-purple-50 p-4 rounded-lg">
                                            <h4 className="font-semibold text-gray-800 mb-3">Prime animation vendeur</h4>
                                            <div className="space-y-2 text-sm">
                                                <div className="flex justify-between"><span>Si ‚â• 1 assurance :</span><span className="font-bold">0,25%</span></div>
                                                <div className="text-xs text-gray-600 mt-2">Vers√©e en annuel</div>
                                            </div>
                                        </div>

                                        <div className="bg-purple-50 p-4 rounded-lg">
                                            <h4 className="font-semibold text-gray-800 mb-3">Prime volume annuel</h4>
                                            <div className="space-y-1 text-xs">
                                                {[
                                                    ['< 500k', '1,15%'], ['‚â• 500k', '1,65%'], ['‚â• 750k', '1,90%'],
                                                    ['‚â• 1M', '2,15%'], ['‚â• 1,5M', '2,40%'], ['‚â• 2M', '2,80%'],
                                                    ['‚â• 2,225M', '3%']
                                                ].map(([s, t], i) => (
                                                    <div key={i} className="flex justify-between py-1 border-b border-purple-200">
                                                        <span>{s}</span><span className="font-bold">{t}</span>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>

                                        <div className="bg-purple-50 p-4 rounded-lg">
                                            <h4 className="font-semibold text-gray-800 mb-3">Prime recours assurances</h4>
                                            <div className="space-y-2 text-sm">
                                                <div className="flex justify-between"><span>Ratio ‚â• 1,65 :</span><span className="font-bold">0,20%</span></div>
                                                <div className="flex justify-between"><span>Ratio ‚â• 1,75 :</span><span className="font-bold">0,30%</span></div>
                                                <div className="flex justify-between"><span>Ratio ‚â• 1,85 :</span><span className="font-bold">0,40%</span></div>
                                            </div>
                                            <div className="text-xs text-gray-600 mt-2">Concerne : d√©c√®s, compl√©mentaire, garantie, r√©vision</div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {ongletActif === 'utilisateurs' && utilisateurActuel?.role === 'admin' && (
                                <div className="p-8">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-6">üë• Gestion des Utilisateurs</h2>

                                    {/* Formulaire de cr√©ation */}
                                    <div className="bg-gradient-to-r from-indigo-50 to-purple-50 p-6 rounded-xl mb-6">
                                        <h3 className="text-lg font-semibold text-gray-800 mb-4">‚ûï Cr√©er un nouvel utilisateur</h3>
                                        <div className="grid md:grid-cols-4 gap-4">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Nom complet</label>
                                                <input
                                                    type="text"
                                                    value={nouveauUser.nom}
                                                    onChange={(e) => setNouveauUser({...nouveauUser, nom: e.target.value})}
                                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg"
                                                    placeholder="Ex: Jean Dupont"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Nom d'utilisateur</label>
                                                <input
                                                    type="text"
                                                    value={nouveauUser.username}
                                                    onChange={(e) => setNouveauUser({...nouveauUser, username: e.target.value})}
                                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg"
                                                    placeholder="Ex: jdupont"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Mot de passe</label>
                                                <input
                                                    type="password"
                                                    value={nouveauUser.password}
                                                    onChange={(e) => setNouveauUser({...nouveauUser, password: e.target.value})}
                                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg"
                                                    placeholder="Min. 6 caract√®res"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">R√¥le</label>
                                                <select
                                                    value={nouveauUser.role}
                                                    onChange={(e) => setNouveauUser({...nouveauUser, role: e.target.value})}
                                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                                    <option value="user">Vendeur</option>
                                                    <option value="admin">Administrateur</option>
                                                </select>
                                            </div>
                                        </div>
                                        <button
                                            onClick={creerUtilisateur}
                                            className="mt-4 px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-medium">
                                            Cr√©er l'utilisateur
                                        </button>
                                    </div>

                                    {/* Liste des utilisateurs */}
                                    <div className="bg-white rounded-xl border border-gray-200">
                                        <table className="w-full">
                                            <thead className="bg-gray-50 border-b">
                                                <tr>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nom</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nom d'utilisateur</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">R√¥le</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Statut</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Date cr√©ation</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-gray-200">
                                                {utilisateurs.map(user => (
                                                    <tr key={user.id} className={!user.actif ? 'bg-gray-50 opacity-60' : ''}>
                                                        <td className="px-6 py-4 text-sm font-medium text-gray-900">{user.nom}</td>
                                                        <td className="px-6 py-4 text-sm text-gray-700">{user.username}</td>
                                                        <td className="px-6 py-4 text-sm">
                                                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${user.role === 'admin' ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800'}`}>
                                                                {user.role === 'admin' ? 'Administrateur' : 'Vendeur'}
                                                            </span>
                                                        </td>
                                                        <td className="px-6 py-4 text-sm">
                                                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${user.actif ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
                                                                {user.actif ? 'Actif' : 'Inactif'}
                                                            </span>
                                                        </td>
                                                        <td className="px-6 py-4 text-sm text-gray-700">
                                                            {new Date(user.createdAt).toLocaleDateString('fr-FR')}
                                                        </td>
                                                        <td className="px-6 py-4 text-sm space-x-2">
                                                            <button
                                                                onClick={() => resetMotDePasse(user.id)}
                                                                className="px-3 py-1 bg-yellow-500 text-white rounded hover:bg-yellow-600 transition text-xs font-medium">
                                                                üîë MDP
                                                            </button>
                                                            <button
                                                                onClick={() => toggleActifUser(user.id)}
                                                                className={`px-3 py-1 ${user.actif ? 'bg-orange-500 hover:bg-orange-600' : 'bg-green-500 hover:bg-green-600'} text-white rounded transition text-xs font-medium`}>
                                                                {user.actif ? '‚è∏Ô∏è D√©sactiver' : '‚ñ∂Ô∏è Activer'}
                                                            </button>
                                                            <button
                                                                onClick={() => supprimerUtilisateur(user.id)}
                                                                className="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition text-xs font-medium">
                                                                üóëÔ∏è Suppr.
                                                            </button>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>

                                    <div className="mt-6 p-4 bg-blue-50 rounded-lg">
                                        <h4 className="font-semibold text-blue-900 mb-2">‚ÑπÔ∏è Informations</h4>
                                        <ul className="text-sm text-blue-800 space-y-1">
                                            <li>‚Ä¢ Les utilisateurs actifs peuvent se connecter √† la calculatrice</li>
                                            <li>‚Ä¢ Les administrateurs ont acc√®s √† cette page de gestion</li>
                                            <li>‚Ä¢ Les mots de passe sont hash√©s pour la s√©curit√©</li>
                                            <li>‚Ä¢ Comptes par d√©faut : admin/Admin2025! et vendeur/Vendeur2025!</li>
                                        </ul>
                                    </div>
                                </div>
                            )}
                        </div>

                        {ongletActif === 'calculatrice' && resultats.length > 0 && (
                            <div className="bg-white rounded-2xl shadow-xl p-8">
                                <h2 className="text-2xl font-bold text-gray-800 mb-6">üéØ R√©sultats</h2>
                                
                                <div className="space-y-4">
                                    {resultats.map((f, idx) => (
                                        <div key={f.id} className={`p-6 rounded-xl border-2 ${idx === 0 ? 'bg-gradient-to-r from-green-50 to-emerald-50 border-green-400' : 'bg-gray-50 border-gray-200'}`}>
                                            <div className="flex justify-between items-start mb-4">
                                                <div>
                                                    <h3 className="text-xl font-bold text-gray-800 flex items-center gap-2">
                                                        {f.nom}
                                                        {idx === 0 && <span className="text-sm px-3 py-1 bg-green-500 text-white rounded-full">‚úì Meilleur</span>}
                                                    </h3>
                                                    {f.type === 'loisirsfinance' && (
                                                        <p className="text-sm text-gray-600 mt-1">
                                                            {f.rem.details.nbAss} assurance(s) ‚Ä¢ Coeff: {(f.rem.details.coeff * 100).toFixed(0)}%
                                                        </p>
                                                    )}
                                                    {f.type === 'arkea' && (
                                                        <p className="text-sm text-gray-600 mt-1">
                                                            {f.rem.details.nbAssurancesArkea} assurance(s) ‚Ä¢ Taux base: {f.rem.details.tauxBase}%
                                                        </p>
                                                    )}
                                                </div>
                                                <div className="text-right">
                                                    <p className="text-3xl font-bold text-indigo-600">
                                                        {f.rem.total.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨
                                                    </p>
                                                    <p className="text-sm text-gray-500">Total r√©mun√©ration</p>
                                                    {(f.type === 'loisirsfinance' || f.type === 'arkea') && (
                                                        <div className="mt-2 text-xs">
                                                            <div className="text-green-700 font-semibold">
                                                                üí∞ {f.rem.totalMensuel.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨ (mensuel)
                                                            </div>
                                                            <div className="text-blue-700 font-semibold">
                                                                üìÖ {f.rem.totalAnnuel.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨ (annuel)
                                                            </div>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>

                                            <button onClick={() => setDetailsOuverts({...detailsOuverts, [f.id]: !detailsOuverts[f.id]})}
                                                className="w-full flex items-center justify-between py-2 px-4 bg-white rounded-lg hover:bg-gray-100 transition">
                                                <span className="text-sm font-medium text-gray-700">Voir d√©tail</span>
                                                {detailsOuverts[f.id] ? <ChevronUp /> : <ChevronDown />}
                                            </button>

                                            {detailsOuverts[f.id] && (
                                                <div className="mt-4 p-4 bg-white rounded-lg space-y-3 text-sm">
                                                    {f.type === 'loisirsfinance' ? (
                                                        <>
                                                            <div className="pb-3 border-b-2 border-green-200">
                                                                <p className="text-xs font-bold text-green-700 mb-2">üí∞ COMMISSION MENSUELLE</p>
                                                                <div className="flex justify-between">
                                                                    <span>Commission base ({f.rem.details.primeBase}% √ó {(f.rem.details.coeff * 100).toFixed(0)}%):</span>
                                                                    <span className="font-bold text-green-700">{f.rem.commBase.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                </div>
                                                            </div>
                                                            
                                                            <div>
                                                                <p className="text-xs font-bold text-blue-700 mb-2">üìÖ PRIMES ANNUELLES</p>
                                                                <div className="space-y-2">
                                                                    <div className="flex justify-between">
                                                                        <span>Prime volume ({f.rem.details.tauxVol}%):</span>
                                                                        <span className="font-bold">{f.rem.primeVol.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                    <div className="flex justify-between">
                                                                        <span>Bonus r√©seau ({f.rem.details.tauxBonusRes}%):</span>
                                                                        <span className="font-bold">{f.rem.montantBonusRes.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                    <div className="flex justify-between">
                                                                        <span>Part interm√©diation (sur bonus annuel de {f.rem.commInter.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨):</span>
                                                                        <span className="font-bold">{f.rem.partDossierInter.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                    <div className="flex justify-between pt-2 border-t border-gray-300">
                                                                        <span className="font-semibold">Total annuel:</span>
                                                                        <span className="font-bold text-blue-700">{f.rem.totalAnnuel.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </>
                                                    ) : f.type === 'arkea' ? (
                                                        <>
                                                            <div className="pb-3 border-b-2 border-green-200">
                                                                <p className="text-xs font-bold text-green-700 mb-2">üí∞ COMMISSION MENSUELLE</p>
                                                                <div className="space-y-2">
                                                                    <div className="flex justify-between">
                                                                        <span>Commission base ({f.rem.details.tauxBase}%):</span>
                                                                        <span className="font-bold">{f.rem.commBase.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                    <div className="flex justify-between">
                                                                        <span>Commissions assurances (%):</span>
                                                                        <span className="font-bold">{f.rem.commAssurances.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                    <div className="flex justify-between">
                                                                        <span>Montants forfaitaires (garantie + r√©vision):</span>
                                                                        <span className="font-bold">{f.rem.montantsForfaitaires.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                    <div className="flex justify-between pt-2 border-t border-gray-300">
                                                                        <span className="font-semibold">Total mensuel:</span>
                                                                        <span className="font-bold text-green-700">{f.rem.totalMensuel.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <div>
                                                                <p className="text-xs font-bold text-blue-700 mb-2">üìÖ PRIMES ANNUELLES</p>
                                                                <div className="space-y-2">
                                                                    <div className="flex justify-between">
                                                                        <span>Prime volume ({f.rem.details.tauxVolume}%):</span>
                                                                        <span className="font-bold">{f.rem.primeVolume.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                    <div className="flex justify-between">
                                                                        <span>Prime recours assurances (ratio {f.rem.details.ratio}):</span>
                                                                        <span className="font-bold">{f.rem.primeRecours.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                    <div className="flex justify-between">
                                                                        <span>Prime animation vendeur (0,25%):</span>
                                                                        <span className="font-bold">{f.rem.primeAnimation.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                    <div className="flex justify-between pt-2 border-t border-gray-300">
                                                                        <span className="font-semibold">Total annuel:</span>
                                                                        <span className="font-bold text-blue-700">{f.rem.totalAnnuel.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </>
                                                    ) : (
                                                        <div className="flex justify-between">
                                                            <span>Commission ({f.rem.details.taux}%):</span>
                                                            <span className="font-bold">{f.rem.comm.toLocaleString('fr-FR', { minimumFractionDigits: 2 })} ‚Ç¨</span>
                                                        </div>
                                                    )}
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<CalculatriceFinanciers />, document.getElementById('root'));
    </script>
</body>
</html>
